---
对象类型: 笔记
aliases: 
tags: 
number headings: auto, first-level 1, max 5, contents ^toc, 1.1.
---
# 1. 数字系统中的数据通路

一般数字系统由以下几个部分构成，数据通路、控制模块、存储模块和互连网络。
![[一般数字处理器的组成.png]]

数据通路是系统的核心，其负责所有的计算。结果存储在存储模块。

存储模块寄存器用于存储可以同时访问的各个数据

互连模块则是将其他所有模块相连接。互连可以采用不同的样式，例如总线或网状互连（点对点）。总线能连接很多模块，但是同时只有一个模块能写总线（但是能同时读总线上的数据）。连接到总线的所有模块的输出都需要[[三态缓冲器]]。

数字系统中的数据通路主要由算术模块组成，常见的算术模块包括加法器（减法器）、乘法器、移位器。

# 2. 算术模块

## 2.1. 移位器

组合移位器对于算术运算非常有用，因为移位相当于乘以 2 的幂。移位寄存器更简单但是每个时钟周期只能移动 1 位。

固定方向和位数的简单移位可以通过硬件重新布线轻松实现。这里主要学习移位器：硬连线移位器、可编程移位器、桶形移位器、对数移位器

[[逻辑移位和算术移位的区别]]

### 2.1.1. 硬连线移位器

硬连线移位器很好理解。硬连线移位器只能用来移动固定位数。

![[硬连线移位器.png|200]]

### 2.1.2. 可编程移位器

![[可编程移位器.png|400]]

1位左右移位器能用于向左或者向右移位 1 位。用于控制的输入同时只能有一个为“1”。

### 2.1.3. 桶式移位器

![[桶式移位器.png]]

桶形移位器的行数为字长，列数为最大的移位宽度。

同样控制输入只能同时有一个为“1”。

其有点在于

### 2.1.4. 左旋转线性桶形移位器

![[左旋转线性桶形移位器.png]]

旋转意味着 LSB 不会丢失，而是会被补充到 MSB。左移就是这里的下移。

### 2.1.5. 对数移位器

通过三阶电路结构，能够实现从 0~7 位的移位。$\log_{2}M$ 阶的移位器能够实现 $M$ 位的最大移位宽度。

![[对数移位器.png]]

对数移位器的优点在于，
1. 控制信号采用编码形式，因此控制信号较少
2. 不需要解码器
3. 对于大移位值比桶形移位器更有效
4. 比桶形移位器面积更小，速度更快

## 2.2. 加法器

加法是最常用的算术运算。它通常也是限速元件。加法器的优化非常重要，优化可以在逻辑（逻辑门）或电路（晶体管）级别进行优化。逻辑级别优化尝试重新排列布尔方程，以便实现更快和/或更小的电路。电路优化控制晶体管尺寸和电路拓扑以优化速度

### 2.2.1. 全加器

![[全加器]]

### 2.2.2. 纹波进位加法器

即将多个全加器的进位和出位相连接。

进位很慢，需要优化进位的速度。
#### 2.2.2.1. 纹波进位加法器的延迟

### 2.2.3. 加法器的反转特性

$$
\mathbf{\overline{{s}}} ( \mathbf{a}, \mathbf{b}, \mathbf{c_{i}} )=\mathbf{s} ( \mathbf{\overline{{a}}}, \mathbf{\overline{{b}}}, \mathbf{\overline{{c_{i}}}} ) \qquad\, \overline{{c}}_{\mathrm{o}} ( \mathbf{a}, \mathbf{b}, \mathbf{c_{i}} )=\mathbf{c}_{\mathrm{o}} ( \mathbf{\overline{{a}}}, \mathbf{\overline{{b}}}, \mathbf{\overline{{c_{i}}}} )
$$

## 2.3. CMOS 全加器

![[CMOS 全加器.png]]

总共使用了 28 个晶体管来实现。

### 2.3.1. 基于传输门的加法器



## 2.4. 乘法器

### 2.4.1. 有符号乘法器

回忆一下[[补码]]。

在有符号乘法器的设计中，需要将减去某数化成取反的形式，对于 $-a$，有 $-a = \overline{a}-1$。

4 位 Baugh-Wooley 阵列乘法器
![[4 位 Baugh-Wooley 阵列乘法器.png]]



# 3. 数据通路结构中的功耗考虑

在 CMOS 设计中，功耗是电源 ($V_{DD}$)、工作频率 (f)、总负载电容 ($C_{L}$) 和开关活动因子（某个信号线或一组信号线在单位时间内的平均翻转次数与总时钟周期数的比值 $\alpha$） 的函数。
$$
{\bf P}={\bf f} \times{\bf C}_{\mathrm{L}} \times{\bf V}_{\mathrm{D D}}^{2} \times\sum\alpha
$$
可以看出，如果降低工作电压能明显降低功耗，但是也会带来高延迟和性能损失。
为了补偿速度的降低，可以使用设计技巧。**并行功能块**在较低频率和较低 $V_{DD}$ 下运行可用于并行处理数据以补偿性能损失。功能块的**流水线结构**也可用于在较低 $V_{DD}$ 时节省功耗需要以相同的速度为较小的电容充电。

还有一些其他的技巧：
- 多种电源电压：以不同速度运行的模块可以使用不同的电源来运行。慢速模块可以在较低 $V_{DD}$ 下运行，而快速模块可以在较高 $V_{DD}$ 下运行
- 动态电压 (V) 和频率 (F) 缩放 (DVFS)：允许多个 F/V 对，针对的是整个系统。
- 掉电模式：放置不需要处理的模块处于待机模式

## 3.1. 时钟门控

![[时钟门控.png]]

第一种电路可能造成错误的时钟信号，导致 FIFO 触发。

## 3.2. 电源门控

功率门控可有效降低功耗。
![[功率门控.png]]




